"use strict";(self.webpackChunkfoxconnect_app=self.webpackChunkfoxconnect_app||[]).push([[898],{28898:function(e,t,n){n.r(t),n.d(t,{default:function(){return pe}});var r=n(29439),a=n(53996),s=n(23132),c=n(47313),o=n(22408),i=n(97890),l=n(69649),u=n(88564),p=n(38768),d=n(5227),h=n(47131),m=n(56993),x=n(46417);var f,g=function(e){return(0,o.I0)(),(0,x.jsxs)("div",{className:"flex flex-col flex-auto",children:[(0,x.jsx)(h.Z,{className:"absolute top-0 right-0 my-16 mx-32 z-10",sx:{color:"gray"},component:d.Z,to:"/apps/customers",size:"large",children:(0,x.jsx)(m.Z,{children:"heroicons-outline:x"})}),(0,x.jsx)(i.j3,{})]})},y=n(56605),v=n(61113),j=n(51938),Z=n(15743),b=n(4942),S=n(74165),w=n(15861),C=n(80827),N=n(35323),k=n(31881),A=n.n(k),I=n(43850),P=n(34814),T=n(45110),z=n(42939),B=(0,C.hg)("customersApp/customers/getCustomers",function(){var e=(0,w.Z)((0,S.Z)().mark((function e(t,n){var r,a,s,c,o;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,a=n.getState,e.prev=1,e.next=4,z.Z.getAccessToken();case 4:return s=e.sent,c=a().organization.organizationId,e.next=8,A().get("/api/".concat(c,"/customer/list"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 8:return o=e.sent,e.abrupt("return",o);case 12:throw e.prev=12,e.t0=e.catch(1),r((0,I.PV)({message:"Get Customer List error",variant:"error"})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()),E=(0,C.HF)({}),F=function(e){return e.customersApp.customers.searchText},L=E.getSelectors((function(e){return e.customersApp.customers})),O=L.selectAll,R=(L.selectById,(0,N.P1)([O,F],(function(e,t){return 0===t.length?e:P.Z.filterArrayByString(e,t)}))),U=(0,N.P1)([R],(function(e){return e.sort((function(e,t){return e.display.localeCompare(t.display,"es",{sensitivity:"base"})})).reduce((function(e,t){var n=t.display[0];return e[n]?e[n].children.push(t):e[n]={group:n,children:[t]},e}),{})})),G=(0,C.oM)({name:"customersApp/customers",initialState:E.getInitialState({searchText:""}),reducers:{setCustomersSearchText:{reducer:function(e,t){e.searchText=t.payload},prepare:function(e){return{payload:e.target.value||""}}}},extraReducers:(f={},(0,b.Z)(f,T.uG.fulfilled,E.upsertOne),(0,b.Z)(f,B.fulfilled,(function(e,t){var n=t.payload,r=n.data;n.routeParams;E.setAll(e,r),e.searchText=""})),f)}),W=G.actions.setCustomersSearchText,H=G.reducer;var M=function(e){var t=(0,o.I0)(),n=(0,o.v9)(F),r=(0,o.v9)(R);return(0,x.jsxs)("div",{className:"p-24 sm:p-32 w-full border-b-1",children:[(0,x.jsxs)("div",{className:"flex flex-col items-center sm:items-start",children:[(0,x.jsx)(v.Z,{component:j.E.span,initial:{x:-20},animate:{x:0,transition:{delay:.2}},delay:300,className:"text-24 md:text-32 font-extrabold tracking-tight leading-none",children:"Customers"}),(0,x.jsx)(v.Z,{component:j.E.span,initial:{y:-20,opacity:0},animate:{y:0,opacity:1,transition:{delay:.2}},delay:500,className:"text-14 font-medium ml-2",color:"text.secondary",children:"".concat(r.length," customers")})]}),(0,x.jsx)("div",{className:"flex flex-col sm:flex-row space-y-16 sm:space-y-0 flex-1 items-center mt-16 -mx-8",children:(0,x.jsxs)(Z.Z,{component:j.E.div,initial:{y:-20,opacity:0},animate:{y:0,opacity:1,transition:{delay:.2}},className:"flex flex-1 w-full sm:w-auto items-center px-16 mx-8 border-1 rounded-full",children:[(0,x.jsx)(m.Z,{color:"action",size:20,children:"heroicons-outline:search"}),(0,x.jsx)(y.Z,{placeholder:"Search customers",className:"flex flex-1 px-16",disableUnderline:!0,fullWidth:!0,value:n,inputProps:{"aria-label":"Search"},onChange:function(e){return t(W(e))}})]})})]})},V=n(48310),_=n(19536),K=n(60194),Y=n(32600),q=n(83213),D=n(63585),J=n(44857),Q=(0,u.ZP)(D.Z)((function(e){var t=e.theme;return{width:22,height:22,border:"2px solid ".concat(t.palette.background.paper)}})),X=function(e){var t=e.contact,n=e.channel;e.className;return t?n&&n.channel?(0,x.jsx)(J.Z,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:(0,x.jsxs)(x.Fragment,{children:["line"===n.channel&&(0,x.jsx)(Q,{alt:n.channel,src:"assets/images/logo/LINE.png"}),"facebook"===n.channel&&(0,x.jsx)(Q,{alt:n.channel,src:"assets/images/logo/Facebook.png"}),"instagram"===n.channel&&(0,x.jsx)(Q,{alt:n.channel,src:"assets/images/logo/Instagram.png"})]}),children:(0,x.jsx)(D.Z,{src:t.pictureURL,alt:t.display,sx:{width:48,height:48}})}):(0,x.jsx)(D.Z,{src:t.pictureURL,alt:t.display,sx:{width:48,height:48}}):null},$=(0,C.hg)("customersApp/channels/getChannels",function(){var e=(0,w.Z)((0,S.Z)().mark((function e(t,n){var r,a,s,c,o;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,a=n.getState,e.prev=1,e.next=4,z.Z.getAccessToken();case 4:return s=e.sent,c=a().organization.organizationId,e.next=8,A().get("/api/".concat(c,"/channel/list"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});case 8:return o=e.sent,e.abrupt("return",o.data);case 12:throw e.prev=12,e.t0=e.catch(1),r((0,I.PV)({message:"Get Channel List error",variant:"error"})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()),ee=(0,C.HF)({}),te=ee.getSelectors((function(e){return e.customersApp.channels})),ne=(te.selectAll,te.selectById),re=(0,C.oM)({name:"customersApp/channels",initialState:ee.getInitialState(),reducers:{},extraReducers:(0,b.Z)({},$.fulfilled,ee.setAll)}),ae=(re.actions.setChannelsSearchText,re.reducer),se=function(e){var t=e.customer,n=(0,o.v9)((function(e){return ne(e,t.channelId)}));return t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(K.ZP,{className:"px-32 py-16",sx:{bgcolor:"background.paper"},button:!0,component:d.Z,to:"/apps/customers/".concat(t.id),children:[(0,x.jsx)(Y.Z,{children:(0,x.jsx)(X,{contact:t,channel:n})}),(0,x.jsx)(q.Z,{classes:{root:"m-0",primary:"font-medium leading-5 truncate"},primary:t.display,secondary:(0,x.jsx)(v.Z,{className:"inline",component:"span",variant:"body2",color:"text.secondary",children:n&&n.data&&n.data.name})})]}),(0,x.jsx)(_.Z,{})]}):null},ce=function(e){var t=(0,o.v9)(R),n=(0,o.v9)(U);return t?0===t.length?(0,x.jsx)("div",{className:"flex flex-1 items-center justify-center h-full",children:(0,x.jsx)(v.Z,{color:"text.secondary",variant:"h5",children:"There are no customers!"})}):(0,x.jsx)(j.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1,transition:{delay:.2}},className:"flex flex-col flex-auto w-full max-h-full",children:Object.entries(n).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return(0,x.jsxs)("div",{className:"relative",children:[(0,x.jsx)(v.Z,{color:"text.secondary",className:"px-32 py-4 text-14 font-medium",children:n}),(0,x.jsx)(_.Z,{}),(0,x.jsx)(V.Z,{className:"w-full m-0 p-0",children:a.children.map((function(e){return(0,x.jsx)(se,{customer:e},e.id)}))})]},n)}))}):null},oe=n(9038),ie=n(91773),le=(0,oe.UY)({labels:ie.ZP,channels:ae,customers:H,customer:T.ZP}),ue=(0,u.ZP)(a.Z)((function(e){return{"& .FusePageSimple-header":{backgroundColor:e.theme.palette.background.paper}}})),pe=(0,s.Z)("customersApp",le)((function(e){var t=(0,o.I0)(),n=(0,c.useRef)(null),a=(0,i.UO)(),s=(0,c.useState)(!1),u=(0,r.Z)(s,2),d=u[0],h=u[1],m=(0,p.Z)((function(e){return e.breakpoints.down("lg")}));return(0,l.KW)((function(){t(B()),t($()),t((0,ie.jk)())}),[t]),(0,c.useEffect)((function(){h(Boolean(a.id))}),[a]),(0,x.jsx)(ue,{header:(0,x.jsx)(M,{pageLayout:n}),content:(0,x.jsx)(ce,{}),ref:n,rightSidebarContent:(0,x.jsx)(g,{}),rightSidebarOpen:d,rightSidebarOnClose:function(){return h(!1)},rightSidebarWidth:640,scroll:m?"normal":"content"})}))}}]);