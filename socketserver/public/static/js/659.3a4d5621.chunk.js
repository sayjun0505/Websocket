"use strict";(self.webpackChunkfoxconnect_app=self.webpackChunkfoxconnect_app||[]).push([[659],{97659:function(e,t,n){n.r(t),n.d(t,{default:function(){return ot}});var a=n(29439),r=n(47313),i=n(22408),l=n(97890),s=n(88564),o=n(53996),c=n(38768),d=n(70022),u=n(93229),p=n(14024),x=n(17988),f=n(1413),m=n(45987),h=n(9506),b=n(61113),Z=n(75908),v=n(5297),j=n(65280),g=n(17551),y=n(56993),w=n(83061),N=n(12547),C=n(93433),k=n(74165),S=n(15861),z=n(34814),I=n(9289),T=n(82295),A=n(56605),E=n(49709),D=n(47131),O=n(48310),L=n(82047),R=n(32530),M=n(51405),P=n(25002),F=n(10368),B=n(24631),U=n(66212),W=n(51938),V=n(60194),$=n(31685),H=n(15743),q=n(64385),G=n(89600),_=n(5227),Q=n(57597),J=n(83911),Y=n(46417),K=(0,s.ZP)(V.ZP)((function(e){var t=e.theme;e.active;return{"&.active":{backgroundColor:t.palette.background.default},"&.label":{borderRadius:6}}})),X=function(e){var t=e.chat,n=(0,i.I0)(),s=(0,c.Z)((function(e){return e.breakpoints.down("lg")})),o=(0,r.useContext)(J.Z).setMainSidebarOpen,p=(0,l.UO)(),x=(0,r.useState)(""),m=(0,a.Z)(x,2),h=m[0],Z=m[1],v=(0,r.useState)([]),j=(0,a.Z)(v,2),g=j[0],y=j[1],N=(0,r.useState)([]),C=(0,a.Z)(N,2),z=C[0],I=C[1],T=(0,i.v9)((function(e){return(0,u.jm)(e,t.channelId)}));(0,r.useMemo)((function(){if(t){if(t.lastMessage){var e=t.lastMessage;if(!e.isDelete&&e.data&&""!==e.data){var n=JSON.parse(e.data);if("text"===e.type){var a=n.text;a.length>30?Z("".concat(a.substring(0,30),"...")):Z(a.substring(0,30))}else"sticker"===e.type?Z("Sticker"):"image"===e.type?Z("Image"):"video"===e.type?Z("Video"):"file"===e.type?Z("File"):"story"===e.type?Z("Reacted to your story"):"story_mention"===e.type?Z("Mention you in a story"):Z("Unknown type")}else Z("This message has been deleted...")}if(t.customer&&t.customer.customerLabel&&t.customer.customerLabel.length>0){var r=0,i=[],l=[];t.customer.customerLabel.forEach(function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n,a){return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r+=n.label.length<10?n.label.length:9,(s&&r<10||!s&&r<17)&&i.length<3?i.push(n):l.push(n),a+1===t.customer.customerLabel.length&&(y(i),I(l));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}),[t,s]);var A=(0,r.useState)(null),D=(0,a.Z)(A,2),O=D[0],L=D[1],R=Boolean(O),M=function(){L(null)};return t&&T?(0,Y.jsx)(K,{className:"flex items-center min-h-80 w-full px-[1rem] py-[1.2rem] !no-underline",active:p.id===t.id,component:_.Z,to:"/apps/chat/".concat(t.id),button:!0,end:!0,activeClassName:"active",onClick:function(){s&&setTimeout((function(){o(!1)}),0),n((0,d.aQ)((0,f.Z)((0,f.Z)({},t),{},{unread:0})))},children:(0,Y.jsxs)("div",{className:"flex items-center flex-row w-full space-x-12",children:[(0,Y.jsx)(Q.f4,{contact:t.customer,channel:T}),(0,Y.jsxs)("div",{className:"flex flex-col grow",children:[(0,Y.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Y.jsx)(b.Z,{variant:"subtitle1",color:"text.primary",className:(0,w.Z)("truncate font-semibold text-[1.4rem]",s?"max-w-[20rem]":"max-w-[25rem]"),children:t.customer.display}),t.lastMessage&&t.lastMessage.createdAt&&(0,Y.jsx)(b.Z,{className:"whitespace-nowra font-medium text-12",color:"text.secondary",children:(new Date).getTime()-864e5<new Date(t.lastMessage.createdAt)?(0,G.Z)(new Date(t.lastMessage.createdAt),"p"):(0,G.Z)(new Date(t.lastMessage.createdAt),"dd/MM/yy")})]}),(0,Y.jsxs)("div",{className:"flex justify-between",children:[(0,Y.jsx)(b.Z,{variant:"body2",className:(0,w.Z)("truncate",s?"max-w-[20rem]":"max-w-[25rem]"),color:"text.secondary",children:(0,Y.jsx)(q.Z,{children:h})}),(0,Y.jsxs)("div",{className:"items-center flex flex-row space-x-6",children:[Boolean(t.newMention)&&(0,Y.jsx)(H.Z,{sx:{backgroundColor:"red",color:"secondary.contrastText"},className:"flex items-center justify-center min-w-20 h-20 rounded-full font-medium text-10 text-center",children:t.newMention&&"@"}),Boolean(t.unread)&&(0,Y.jsx)(H.Z,{sx:{backgroundColor:"secondary.main",color:"secondary.contrastText"},className:"flex items-center justify-center min-w-20 h-20 rounded-full font-medium text-10 text-center",children:t.unread})]})]}),(0,Y.jsxs)("div",{className:"flex flex-row space-x-4 max-w-240 pt-4",children:[(0,Y.jsx)(E.Z,{title:T.name,arrow:!0,children:(0,Y.jsx)(U.Z,{size:"small",className:"w-min my-1 rounded bg-[#6D6D6D] text-[#FFFFFF] truncate max-w-96 text-[1.2rem]",label:"".concat(T.name)})}),g&&g.length>0&&g.map((function(e,t){return(0,Y.jsx)(U.Z,{size:"small",variant:"outlined",className:"w-min m-1 truncate rounded w-42 text-[1.2rem]",label:e.label,sx:{borderColor:"#8180E7",color:"#8180E7"}},t)})),z&&z.length>0&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(U.Z,{id:"morechatlabel-button",size:"small",className:"w-min my-1 rounded text-20 text-white bg-[#8180E7]",label:"+",onClick:function(e){e.preventDefault(),L(e.currentTarget)}}),(0,Y.jsx)(P.ZP,{id:"popover-morechatlabel",anchorOrigin:{vertical:"bottom",horizontal:"left"},open:R,anchorEl:O,onClose:M,children:(0,Y.jsx)($.Z,{onClickAway:function(){M()},children:(0,Y.jsx)("div",{className:"flex flex-col space-y-6 p-8",children:z&&z.length>0&&z.map((function(e,t){return(0,Y.jsx)(U.Z,{size:"small",variant:"outlined",className:"w-min m-1 truncate rounded w-42 text-[1.2rem]",label:e.label,sx:{borderColor:"#8180E7",color:"#8180E7"}},t)}))})})})]})]})]})]})}):null},ee=n(25850),te={show:{transition:{staggerChildren:.1}}},ne={hidden:{opacity:0,y:20},show:{opacity:1,y:0}},ae=function(){var e=(0,i.I0)(),t=(0,ee.l)(),n=t.eventUpdate,l=(t.tabHasFocus,(0,i.v9)(d.Rt)),s=(0,i.v9)(p.ir),o=(0,i.v9)((function(e){return e.user.role})),c=(0,i.v9)((function(e){return e.chatApp.chats})),u=(c.chatListType,c.labelFilter),x=(0,r.useState)(1),m=(0,a.Z)(x,2),v=(m[0],m[1],(0,r.useState)(10)),j=(0,a.Z)(v,2),w=(j[0],j[1],(0,r.useState)(null)),N=(0,a.Z)(w,2),V=N[0],$=N[1],H=function(e){$(e.currentTarget)},q=(0,r.useState)([]),G=(0,a.Z)(q,2),_=G[0],Q=G[1],J=(0,r.useState)(""),K=(0,a.Z)(J,2),ae=K[0],re=K[1],ie=(0,r.useState)(null),le=(0,a.Z)(ie,2),se=le[0],oe=le[1],ce=Boolean(se),de=function(e){oe(e.currentTarget)},ue=function(){oe(null)};(0,r.useEffect)((function(){n&&n<new Date&&e((0,d.zG)({}))}),[e,n]),(0,r.useEffect)((function(){o&&("agent"===o?(e((0,d.ju)("assignee")),e((0,d.zG)({type:"assignee"})),Q([{key:"assignee",label:"Assigned to me"},{key:"mention",label:"@Mentions"}])):(e((0,d.ju)("active")),e((0,d.zG)({type:"active"})),Q([{key:"all",label:"All Chats"},{key:"unassign",label:"Unassigned All"},{key:"active",label:"All Active"},{key:"resolve",label:"All Resolved"},{key:"followup",label:"All Follow Up"},{key:"assignee",label:"Assigned to me"},{key:"mention",label:"@Mentions"},{key:"line",label:"Channel: LINE"},{key:"facebook",label:"Channel: Facebook"}])))}),[e,o]);function pe(e){re(e.target.value)}var xe=function(){var t=(0,S.Z)((0,k.Z)().mark((function t(n,a){return(0,k.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e((0,d._7)(a)),e((0,d.zG)({filterLabel:a.map((function(e){return e.label}))}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(Z.Z,{position:"static",color:"default",elevation:0,children:(0,Y.jsx)(h.Z,{className:"pt-16 border-b-1 h-72",sx:{backgroundColor:function(e){return"light"===e.palette.mode?(0,g.$n)(e.palette.background.default,.4):(0,g.$n)(e.palette.background.default,.02)}},children:(0,Y.jsx)(I.Z,{className:"flex flex-col space-y-8 px-12",children:(0,r.useMemo)((function(){return(0,Y.jsxs)("div",{className:"flex w-full justify-between space-x-8",children:[(0,Y.jsxs)(T.Z,{className:"flex items-center w-full pl-16 pr-0 border-1 h-40 rounded-full shadow-none",children:[(0,Y.jsx)(y.Z,{color:"action",size:20,children:"heroicons-solid:search"}),(0,Y.jsx)(A.Z,{placeholder:"Search chat",className:"flex flex-1 px-8",disableUnderline:!0,fullWidth:!0,value:ae,inputProps:{"aria-label":"Search"},onChange:pe}),(0,Y.jsx)(E.Z,{title:(0,Y.jsx)(b.Z,{color:"inherit",children:"Filter"}),className:"relative",placement:"top",children:(0,Y.jsx)(D.Z,{"aria-haspopup":"true","aria-expanded":ce?"true":void 0,"aria-controls":ce?"basic-menu":void 0,className:"relative",onClick:de,children:(0,Y.jsx)(y.Z,{className:"text-48 text-gray-500",size:24,children:"material-outline:sort"})})})]}),(0,Y.jsx)(E.Z,{title:(0,Y.jsx)(b.Z,{color:"inherit",children:"Labels"}),placement:"top",children:(0,Y.jsx)(D.Z,{"aria-label":"more",color:"primary",className:"flex items-center",onClick:H,children:(0,Y.jsx)(y.Z,{className:"text-48 text-gray-500",size:24,children:"material-outline:label"})})})]})}),[H,ce,ae])})})}),(0,Y.jsx)(O.Z,{className:"w-full p-0 overflow-hidden",children:(0,r.useMemo)((function(){var e,t,n=(e=(0,C.Z)(l),0===(t=ae).length?e:z.Z.filterArrayByString(e,t));return(0,Y.jsx)(W.E.div,{className:"flex flex-col flex-shrink-0 w-full min-h-px",variants:te,initial:"hidden",animate:"show",children:n&&n.length>0?(0,Y.jsx)(Y.Fragment,{children:n.map((function(e,t){return(0,Y.jsx)(W.E.div,{variants:ne,children:(0,Y.jsx)(X,{chat:e})},t)}))}):(0,Y.jsx)(T.Z,{className:"flex flex-1 flex-row min-h-px shadow-0",children:(0,Y.jsxs)("div",{className:"flex flex-col flex-1 items-center justify-center p-24",children:[(0,Y.jsx)(y.Z,{size:128,color:"disabled",children:"heroicons-outline:chat"}),(0,Y.jsx)(b.Z,{className:"px-16 pb-24 mt-24 text-center",color:"text.secondary",children:"No Chat conversation."})]})})})}),[l,ae])}),(0,Y.jsx)(L.Z,{id:"basic-menu",anchorEl:se,open:ce,onClose:ue,TransitionComponent:R.Z,className:"absolute",children:_.map((function(t,n){return(0,Y.jsx)(M.Z,{value:t.key,onClick:function(){var n;n=t.key,ue(),e((0,d.ju)(n)),e((0,d.zG)({chatType:n}))},children:t.label},n)}))}),(0,Y.jsx)(P.ZP,{open:Boolean(V),anchorEl:V,onClose:function(){$(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},classes:{paper:"py-8"},children:(0,Y.jsx)("div",{className:"flex min-w-200 max-w-xl p-12",children:(0,Y.jsxs)("div",{className:"flex flex-col px-8 items-start w-full",children:[(0,Y.jsx)(b.Z,{className:"font-medium",color:"primary",children:"Filter by Label"}),(0,Y.jsx)(F.Z,{multiple:!0,freeSolo:!0,className:"w-full pt-8",id:"tags-outlined",options:s,getOptionLabel:function(e){return e.label},value:u,onChange:xe,filterSelectedOptions:!0,renderInput:function(e){return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},e),{},{variant:"outlined",placeholder:"Label",multiline:!0}))},renderTags:function(e,t){return e.map((function(e,n){return(0,Y.jsx)(U.Z,(0,f.Z)({label:e.label,sx:{borderRadius:"4px"},size:"small",color:"secondary",variant:"outlined",className:"w-min my-1 rounded"},t({index:n})))}))}})]})})})]})},re=n(47897),ie=(0,s.ZP)(V.ZP)((function(e){var t=e.theme;e.active;return{"&.active":{backgroundColor:t.palette.background.default}}})),le=function(e){var t=e.history,n=(0,c.Z)((function(e){return e.breakpoints.down("lg")})),a=(0,l.UO)(),s=(0,r.useContext)(J.Z).setMainSidebarOpen,o=(0,i.v9)((function(e){return(0,u.jm)(e,t.channelId)}));return t&&o&&0!==t.totalChat?(0,Y.jsx)(ie,{button:!0,className:"flex items-center p-12 min-h-80 w-full",active:a.id===t.id?1:0,component:_.Z,to:"/apps/chat/".concat(t.lastChat.id,"/history"),end:!0,activeClassName:"active",onClick:function(){n&&setTimeout((function(){s(!1)}),0)},children:(0,Y.jsxs)("div",{className:"flex items-center flex-row w-full space-x-12",children:[(0,Y.jsx)(Q.f4,{className:"relative w-48 h-48",contact:{pictureURL:t.pictureURL,display:t.display},channel:o}),(0,Y.jsxs)("div",{className:"flex flex-col grow",children:[(0,Y.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Y.jsx)(b.Z,{variant:"subtitle1",className:"truncate font-bold max-w-160",color:"text.primary",children:t.display}),t.lastChat&&t.lastChat.createdAt?(0,Y.jsx)(b.Z,{className:"whitespace-nowra font-medium text-12",color:"text.secondary",children:(new Date).getTime()-864e5<new Date(t.lastChat.createdAt)?(0,G.Z)(new Date(t.lastChat.createdAt),"p"):(0,G.Z)(new Date(t.lastChat.createdAt),"dd/MM/yy")}):(0,Y.jsx)(b.Z,{className:"whitespace-nowra font-medium text-12",color:"text.secondary",children:(new Date).getTime()-864e5<new Date(t.createdAt)?(0,G.Z)(new Date(t.createdAt),"p"):(0,G.Z)(new Date(t.createdAt),"dd/MM/yy")})]}),(0,Y.jsxs)("div",{className:"flex justify-between",children:[(0,Y.jsx)(E.Z,{title:o.name,arrow:!0,children:(0,Y.jsx)(U.Z,{size:"small",className:"w-min my-1 rounded bg-[#6D6D6D] text-[#FFFFFF] truncate max-w-96",label:"".concat(o.name)})}),(0,Y.jsx)(b.Z,{className:"whitespace-nowrap mb-8 font-medium text-12",color:"textSecondary",children:"".concat(t.totalChat," chat")})]})]})]})}):null},se={show:{transition:{staggerChildren:.1}}},oe={hidden:{opacity:0,y:20},show:{opacity:1,y:0}},ce=function(e){var t=(0,i.I0)(),n=(0,ee.l)(J.Z),l=n.eventUpdate,s=(n.tabHasFocus,(0,i.v9)(re.hq)),o=(0,r.useState)(null),c=(0,a.Z)(o,2),d=(c[0],c[1],(0,r.useState)(null)),u=(0,a.Z)(d,2);u[0],u[1];(0,r.useEffect)((function(){t((0,re.wT)())}),[t]),(0,r.useEffect)((function(){l&&l<new Date&&t((0,re.wT)())}),[t,l]);var p=(0,r.useState)(""),x=(0,a.Z)(p,2),f=x[0],m=x[1];function b(e){m(e.target.value)}return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(Z.Z,{position:"static",color:"default",elevation:0,children:(0,Y.jsx)(h.Z,{className:"pt-16 border-b-1 h-72",sx:{backgroundColor:function(e){return"light"===e.palette.mode?(0,g.$n)(e.palette.background.default,.4):(0,g.$n)(e.palette.background.default,.02)}},children:(0,Y.jsx)(I.Z,{className:"flex flex-col space-y-8",children:(0,r.useMemo)((function(){return(0,Y.jsxs)(T.Z,{className:"flex p-4 items-center w-full px-16 py-4 border-1 h-40 rounded-full shadow-none",children:[(0,Y.jsx)(y.Z,{color:"action",size:20,children:"heroicons-solid:search"}),(0,Y.jsx)(A.Z,{placeholder:"Search customer",className:"flex flex-1 px-8",disableUnderline:!0,fullWidth:!0,value:f,inputProps:{"aria-label":"Search"},onChange:b})]})}),[f])})})}),(0,Y.jsx)(O.Z,{className:"w-full p-0 overflow-hidden",children:(0,r.useMemo)((function(){var e,t,n=(e=(0,C.Z)(s),0===(t=f).length?e:z.Z.filterArrayByString(e,t));return(0,Y.jsx)(W.E.div,{className:"flex flex-col flex-shrink-0 w-full",variants:se,initial:"hidden",animate:"show",children:n.map((function(e,t){return(0,Y.jsx)(W.E.div,{variants:oe,children:(0,Y.jsx)(le,{history:e})},t)}))})}),[s,f])})]})},de=["children","value","index"],ue=function(e){var t=e.children,n=e.value,a=e.index,r=(0,m.Z)(e,de);return(0,Y.jsx)("div",(0,f.Z)((0,f.Z)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),{},{children:n===a&&(0,Y.jsx)(h.Z,{sx:{p:0},children:(0,Y.jsx)(b.Z,{children:t})})}))};function pe(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var xe=function(e){var t=(0,c.Z)((function(e){return e.breakpoints.down("lg")})),n=(0,r.useState)(0),i=(0,a.Z)(n,2),l=i[0],s=i[1];return(0,Y.jsxs)(h.Z,{sx:{bgcolor:"background.paper"},className:(0,w.Z)(t?"w-[333px]":"w-full"),children:[(0,Y.jsx)(Z.Z,{position:"static",children:(0,Y.jsxs)(v.Z,{value:l,onChange:function(e,t){s(t)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"chat and history tabs",sx:{padding:"0px",backgroundColor:function(e){return"light"===e.palette.mode?(0,g.$n)(e.palette.background.default,.4):(0,g.$n)(e.palette.background.default,.02)}},children:[(0,Y.jsx)(j.Z,(0,f.Z)({icon:(0,Y.jsx)(y.Z,(0,f.Z)((0,f.Z)({color:"inherit",size:20},pe(0)),{},{children:"material-outline:chat"}))},pe(0))),(0,Y.jsx)(j.Z,(0,f.Z)({icon:(0,Y.jsx)(y.Z,(0,f.Z)((0,f.Z)({color:"inherit",size:20},pe(1)),{},{children:"material-outline:history"}))},pe(1)))]})}),(0,Y.jsxs)(N.ZP,{index:l,onChangeIndex:function(e){s(e)},children:[(0,Y.jsx)(ue,{value:l,index:0,children:(0,Y.jsx)(ae,{})}),(0,Y.jsx)(ue,{value:l,index:1,children:(0,Y.jsx)(ce,{})})]})]})},fe=n(52500),me=n(63445),he=n(92550),be=n(24193),Ze=n(85281),ve=n(9619),je=n(89302),ge=n(58631),ye=n(35336),we=(0,s.ZP)("div")((function(e){var t=e.theme;return{position:"relative",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-end",padding:"0 16px 4px 16px",flex:"0 0 auto","& .avatar":{position:"absolute",left:-32,margin:0},"& .bubble":{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:12,maxWidth:"100%"},"& .message":{whiteSpace:"pre-wrap",lineHeight:1.2},"& .time":{position:"absolute",display:"none",width:"100%",fontSize:11,marginTop:2,top:"100%",left:0,whiteSpace:"nowrap"},"&.contact":{"& .bubble":{backgroundColor:"#64748B",color:t.palette.secondary.contrastText,borderTopLeftRadius:5,borderBottomLeftRadius:5,borderTopRightRadius:20,borderBottomRightRadius:20,"& .pin":{display:"none"},"& .pinned":{right:"-8rem"},":hover":{backgroundColor:"#d5ecff","& .pin":{display:"flex",right:"-5rem"}}},"&.first-of-group":{"& .bubble":{borderTopLeftRadius:20}},"&.last-of-group":{"& .bubble":{borderBottomLeftRadius:20}}},"&.me":{paddingLeft:40,"& .avatar":{order:2,margin:"0 0 0 16px"},"& .bubble":{marginLeft:"auto",backgroundColor:"#2559C7",color:t.palette.primary.contrastText,borderTopLeftRadius:20,borderBottomLeftRadius:20,borderTopRightRadius:5,borderBottomRightRadius:5,"& .pin":{display:"none"},"& .pinned":{left:"-8rem"},":hover":{backgroundColor:"#1d2838b0","& .pin":{display:"flex",left:"-5rem"}},"& .time":{justifyContent:"flex-end",right:0,marginRight:12}},"&.first-of-group":{"& .bubble":{borderTopRightRadius:20}},"&.last-of-group":{"& .bubble":{borderBottomRightRadius:20}}},"&.contact + .me, &.me + .contact":{paddingTop:20,marginTop:20},"&.contact + .contact":{"&.first-of-group":{"& .bubble":{marginTop:20}}},"&.first-of-group":{"& .bubble":{borderTopLeftRadius:20,paddingTop:13}},"&.last-of-group":{"& .bubble":{borderBottomLeftRadius:20,paddingBottom:13,"& .time":{display:"flex"}}},"&.pin":{"& .bubble":{backgroundColor:t.palette.background.paper,color:t.palette.getContrastText(t.palette.background.paper),borderRadius:20}}}})),Ne=function(e){var t=(0,i.I0)(),n=(0,l.UO)(),s=((0,l.TH)(),n.id),o=(0,c.Z)((function(e){return e.breakpoints.down("lg")})),d=(0,r.useContext)(J.Z),u=(d.customerSidebarOpen,d.commentSidebarOpen),p=(d.handleRightSidebarClose,(0,i.v9)(ge.dy).uuid),m=(0,i.v9)(x.YN),Z=(0,i.v9)(ye.UL),v=(0,r.useRef)(null),j=(0,r.useState)([]),N=(0,a.Z)(j,2),C=N[0],z=N[1],I=(0,r.useState)([]),A=(0,a.Z)(I,2),E=A[0],O=A[1],L=(0,r.useState)(!1),M=(0,a.Z)(L,2),P=M[0],F=M[1],B=(0,r.useState)(!1),U=(0,a.Z)(B,2),W=(U[0],U[1],(0,r.useState)(!1)),V=(0,a.Z)(W,2),$=V[0],H=V[1],G=(0,r.useState)((function(){return fe.EditorState.createEmpty()})),_=(0,a.Z)(G,2),K=_[0],X=_[1];(0,r.useEffect)((function(){s&&(console.log("\u270a\ud83c\udffb [CommentSidebar] chatId ",s),t((0,ye.li)({chatId:s})))}),[s,t]),(0,r.useEffect)((function(){if(console.log("\u270a\ud83c\udffb [comments] length  ",Z.length),Z&&Z.length>0){z(Z);var e;e=Z.filter((function(e){return e.isPin})),O(e)}}),[Z]),(0,r.useEffect)((function(){u||z([])}),[u]);var ee=function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n){var a;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:F(!0),(a=new FormData).append("file",n.target.files[0]),t((0,ye.vx)({formData:a,chatId:s})).then((function(){setTimeout((function(){F(!1)}),5e3)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function te(e){e.preventDefault();var n=K.getCurrentContent(),a=me.Z.formatTextToMention(n.getPlainText(),(0,fe.convertToRaw)(n).entityMap);""!==a.trim()&&(t((0,ye.II)({messageText:a,chatId:s})).then((function(){X(fe.EditorState.createEmpty())})),v&&v.current&&v.current.scrollHeight&&(v.current.scrollTop=v.current.scrollHeight))}var ne=function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n){return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t((0,ye._f)({id:n.id,isPin:!0}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n){return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t((0,ye._f)({id:n.id,isPin:!1}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){H(!$)},ie=function(e,t){return 0===t||C[t-1]&&C[t-1].createdBy.id!==e.createdBy.id},le=function(e,t){return t===C.length-1||C[t+1]&&C[t+1].createdBy.id!==e.createdBy.id};return(0,Y.jsxs)("div",{className:(0,w.Z)(o?"w-[333px]":"w-[398px]","flex flex-col flex-1 h-[calc(100vh-64px)] overflow-hidden"),children:[(0,Y.jsx)("div",{className:"flex flex-col flex-1 w-full left-0 right-0 top-0 z-30",children:E&&E.length>0&&(0,Y.jsxs)(h.Z,{style:{width:"-webkit-fill-available"},sx:{backgroundColor:function(e){return"light"===e.palette.mode?(0,g.$n)(e.palette.primary.light,.85):(0,g.$n)(e.palette.primary.light,.02)}},children:[(0,Y.jsxs)("div",{className:"flex flex-row items-center p-10 py-5",id:"pin-menu",onClick:re,onKeyDown:re,"aria-hidden":"true",role:"button",tabIndex:0,children:[(0,Y.jsxs)("div",{children:[(0,Y.jsx)(je.Z,{htmlColor:"black",fontSize:"small",style:{paddingRight:"0.3rem"}}),null===E||void 0===E?void 0:E.length," Pinned"]}),(0,Y.jsx)(y.Z,{className:"text-48",size:24,color:"action",children:$?"material-solid:arrow_drop_up":"material-solid:arrow_drop_down"})]}),(0,Y.jsx)(R.Z,{in:$,children:(0,Y.jsx)("div",{className:"flex flex-col p-14",style:$?{display:"flex",flexDirection:"column"}:{display:"none"},children:E.map((function(e,t){var n="";return n=e.type&&"text"===e.type?me.Z.formatMentionToText(JSON.parse(e.data).text):"file"===e.type?"File":"image"===e.type?"Image":"Unknown type",(0,Y.jsx)("div",{className:"w-full rounded-xl ",sx:{backgroundColor:function(e){return"light"===e.palette.mode?(0,g.$n)(e.palette.primary.light,.85):(0,g.$n)(e.palette.primary.light,.02)},color:function(e){return e.palette.mode,e.palette.primary.contrastText}},children:(0,Y.jsxs)(we,{"data-to-scrollspy-id":e.id,className:(0,w.Z)("flex flex-col grow-0 shrink-0 items-start justify-end relative px-16 pb-4","pin"),children:[(0,Y.jsxs)("div",{className:"bubble flex relative items-center justify-center p-12 max-w-[90%]",children:[e.type&&"text"===e.type&&(0,Y.jsx)(q.Z,{componentDecorator:function(e,t,n){return(0,Y.jsx)("a",{target:"blank",href:e,className:"!text-cyan-400",children:t},n)},children:(0,Y.jsx)("span",{className:"break-words whitespace-pre-wrap max-w-full",children:n})}),e.type&&"image"===e.type&&(0,Y.jsx)("div",{className:"message",children:(0,Y.jsx)("img",{src:JSON.parse(e.data).url,alt:e.id,className:" h-auto min-w-0"})})]}),(0,Y.jsxs)(b.Z,{className:"contents text-xs",color:"textSecondary",children:[e.createdBy?(0,Y.jsxs)("b",{children:[e.createdBy.display,"\xa0\xa0"]}):null,e.createdAt?(0,ve.Z)(new Date(e.createdAt),{addSuffix:!1}):null]}),(0,Y.jsx)(D.Z,{color:"inherit",size:"small",className:"absolute top-0 right-[1rem]",onClick:function(){return ae(e)},children:(0,Y.jsx)(y.Z,{size:14,children:"heroicons-outline:x"})})]})},t)}))})})]})}),(0,Y.jsx)("div",{className:"flex flex-auto min-h-0 h-full w-full",children:(0,Y.jsxs)("div",{className:"flex flex-1 z-10 flex-col max-w-[400px]",children:[(0,Y.jsx)(he.Z,{ref:v,className:"flex flex-1 flex-col overflow-y-scroll",children:(0,Y.jsxs)("div",{className:"flex flex-col h-full",children:[(!C||C.length<=0)&&(0,Y.jsxs)("div",{className:"flex flex-col flex-1 items-center justify-center p-24 w-full",children:[(0,Y.jsx)(y.Z,{size:128,color:"disabled",children:"heroicons-outline:chat"}),(0,Y.jsx)(b.Z,{className:"px-16 pb-24 mt-24 text-center ",color:"text.secondary",children:"No Comment."})]}),(0,Y.jsx)("div",{className:"flex flex-col pt-16 pb-120",children:C.map((function(e,t){var n="";return n=e.type&&"text"===e.type?me.Z.formatMentionToText(JSON.parse(e.data).text):"file"===e.type?"File":"image"===e.type?"Image":"Unknown type",(0,Y.jsx)(we,{id:e.id,className:(0,w.Z)({me:(null===e||void 0===e?void 0:e.createdBy.id)===p},{contact:(null===e||void 0===e?void 0:e.createdBy.id)!==p},{"first-of-group":ie(e,t)},{"last-of-group":le(e,t)}),children:(0,Y.jsxs)("div",{className:"bubble shadow max-w-[90%]",children:[e.type&&"text"===e.type&&(0,Y.jsx)(q.Z,{componentDecorator:function(e,t,n){return(0,Y.jsx)("a",{target:"blank",href:e,className:"!text-cyan-400",children:t},n)},children:(0,Y.jsx)("span",{className:"break-words whitespace-pre-wrap max-w-full",children:n})}),e.type&&"image"===e.type&&(0,Y.jsx)("div",{className:"message",children:(0,Y.jsx)("img",{src:JSON.parse(e.data).url,alt:e.id,className:"h-auto min-w-0"})}),(0,Y.jsxs)(b.Z,{className:"time",color:"textSecondary",children:[e.createdBy?(0,Y.jsxs)("b",{children:[e.createdBy.display,"\xa0\xa0"]}):null,e.createdAt?(0,ve.Z)(new Date(e.createdAt),{addSuffix:!1}):null]}),e.isPin?(0,Y.jsx)(be.Z,{variant:"text",size:"small",className:"text-gray absolute pinned",startIcon:(0,Y.jsx)(je.Z,{htmlColor:"#5dd4fcc7",fontSize:"small"}),onClick:function(){return ae(e)},children:"Pinned"}):(0,Y.jsx)(be.Z,{variant:"contained",size:"small",className:"text-white bg-[#00bfff8a] hover:bg-[#5dd4fc60] pin absolute",startIcon:(0,Y.jsx)(je.Z,{htmlColor:"white",fontSize:"small"}),onClick:function(){return ne(e)},children:"Pin"})]})},t)}))})]})}),(0,Y.jsx)(T.Z,{square:!0,component:"form",autoComplete:"off",onSubmit:te,className:"sticky border-t-1 bottom-0 right-0 left-0 py-16 px-16",sx:{backgroundColor:function(e){return"light"===e.palette.mode?(0,g.$n)(e.palette.background.default,.4):(0,g.$n)(e.palette.background.default,.02)}},children:(0,Y.jsxs)("div",{className:" flex space-x-4 items-center relative break-word overflow-x-hidden",children:[(0,Y.jsx)("div",{className:"flex-none",children:P?(0,Y.jsx)("div",{className:"p-12",children:(0,Y.jsx)(Ze.Z,{color:"inherit",size:24})}):(0,Y.jsxs)(D.Z,{size:"large",component:"label",children:[(0,Y.jsx)("input",{hidden:!0,accept:"image/gif, image/png, image/jpeg, video/mp4, application/pdf, application/msword, application/vnd.ms-excel,application/vnd.ms-powerpoint, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.openxmlformats-officedocument.presentationml.slideshow, application/vnd.openxmlformats-officedocument.presentationml.presentation",onChange:ee,type:"file"}),(0,Y.jsx)(y.Z,{children:"heroicons-outline:paper-clip"})]})}),(0,Y.jsx)(Q.sU,{editorState:K,setEditorState:X,onMessageSubmit:te,options:m&&m.map((function(e){return(0,f.Z)((0,f.Z)({},e),{},{link:e.email,name:e.display})}))}),(0,Y.jsx)("div",{className:"flex-none",children:(0,Y.jsx)(D.Z,{className:"",onClick:te,size:"large",disabled:P,children:(0,Y.jsx)(y.Z,{className:"rotate-90",color:"action",children:"heroicons-outline:paper-airplane"})})})]})})]})})]})},Ce=n(6306),ke=n(52769),Se=n(98492),ze=n(41872),Ie=n(45563),Te=n(20275),Ae=n(63738),Ee=n(83213),De=n(65954),Oe=n(51997),Le=n(64516),Re=n(94469),Me=n(4117),Pe=n(96467),Fe=n(97762),Be=n(33604),Ue=n(98112),We=n(5211),Ve=function(e){var t=(0,i.I0)(),n=(0,i.v9)((function(e){return e.chatApp.address.addressDialog})),l=((0,i.v9)((function(e){return e.chatApp.customer})),(0,r.useState)([])),s=(0,a.Z)(l,2),o=s[0],c=s[1],d=(0,r.useState)({}),u=(0,a.Z)(d,2),p=(u[0],u[1]),x=(0,r.useState)(""),m=(0,a.Z)(x,2),h=m[0],v=(m[1],(0,r.useState)("")),j=(0,a.Z)(v,2),g=j[0],y=(j[1],(0,r.useState)("")),w=(0,a.Z)(y,2),N=w[0],C=(w[1],(0,r.useState)("")),k=(0,a.Z)(C,2),S=k[0],z=(k[1],(0,r.useState)("")),T=(0,a.Z)(z,2),A=T[0],E=T[1],D=(0,r.useState)(""),O=(0,a.Z)(D,2),L=O[0],R=O[1],M=(0,r.useState)(""),P=(0,a.Z)(M,2),U=P[0],W=P[1],V=(0,r.useState)(""),$=(0,a.Z)(V,2),H=$[0],q=$[1],G=(0,r.useState)(""),_=(0,a.Z)(G,2),Q=_[0],J=_[1],K=(0,r.useState)(""),X=(0,a.Z)(K,2),ee=X[0],te=X[1],ne=(0,r.useState)(""),ae=(0,a.Z)(ne,2),re=ae[0],ie=ae[1],le=(0,r.useState)(""),se=(0,a.Z)(le,2),oe=se[0],ce=se[1];function de(){return"edit"===n.type?t((0,We.OJ)()):t((0,We.p2)())}(0,r.useEffect)((function(){n.props.open&&"edit"===n.type&&n.data&&(E(n.data.name||""),R(n.data.tel||""),W(n.data.address1||""),q(n.data.address2||""),J(n.data.subDistrict||""),te(n.data.district||""),ie(n.data.province||""),ce(String(n.data.zipCode)||""))}),[n.props.open,n]),(0,r.useEffect)((function(){n.props.open||(E(""),R(""),W(""),q(""),J(""),te(""),ie(""),ce(""))}),[n.props.open]);var ue=function(e){return function(t){switch(e){case"name":E(t.target.value);break;case"tel":R(t.target.value);break;case"address1":W(t.target.value);break;case"address2":q(t.target.value)}}},pe=function(e){var t=e.map((function(e,t){return(0,f.Z)({key:t,label:"".concat(e.district).concat(",").concat(e.amphoe).concat(",").concat(e.province).concat(",").concat(e.zipcode)},e)}));t.length>0&&c(t)};return(0,Y.jsxs)(Re.Z,(0,f.Z)((0,f.Z)({classes:{paper:"m-24"}},n.props),{},{onClose:de,fullWidth:!0,maxWidth:"sm",children:[(0,Y.jsx)(Z.Z,{position:"static",elevation:0,children:(0,Y.jsx)(I.Z,{className:"flex flex-col justify-center items-center p-12",children:(0,Y.jsx)(b.Z,{variant:"subtitle1",color:"inherit",children:"new"===n.type?"New Address":"Edit Address"})})}),(0,Y.jsxs)("form",{onSubmit:function(e){e.preventDefault();var a=(0,f.Z)((0,f.Z)({},n.data),{},{name:A,tel:L,address1:U,address2:H,subDistrict:Q,district:ee,province:re,zipCode:oe});"new"===n.type?t((0,We.y$)((0,f.Z)({},a))):t((0,We.y3)((0,f.Z)((0,f.Z)({},n.data),a))),de()},className:"flex flex-col md:overflow-hidden",children:[(0,Y.jsxs)(Pe.Z,{classes:{root:"p-24"},children:[(0,Y.jsx)(B.Z,{onChange:ue("name"),value:A,className:"mb-24",label:"Name",id:"name",variant:"outlined",required:!0,fullWidth:!0}),(0,Y.jsx)(B.Z,{onChange:ue("tel"),value:L,className:"mb-24",label:"Phone number",id:"tel",variant:"outlined",required:!0,fullWidth:!0}),(0,Y.jsx)(B.Z,{onChange:ue("address1"),value:U,className:"mb-24",label:"Address 1",id:"address1",variant:"outlined",required:!0,fullWidth:!0,multiline:!0,rows:3}),(0,Y.jsx)(B.Z,{onChange:ue("address2"),value:H,className:"mb-24",label:"Address 2",id:"address2",variant:"outlined",multiline:!0,rows:3,fullWidth:!0}),(0,Y.jsx)(F.Z,{freeSolo:!0,value:h,onChange:function(e,t){p(t),t&&t.district&&J(t.district),t&&t.amphoe&&te(t.amphoe),t&&t.province&&ie(t.province),t&&t.zipcode&&ce(String(t.zipcode))},getOptionLabel:function(e){return e.label||Q||""},inputValue:Q,onInputChange:function(e,t){J(t),""!==t&&pe((0,Ue.searchAddressByDistrict)(t).slice(0,10))},id:"auto-subdistrict",options:o,sx:{width:300},renderInput:function(e){return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},e),{},{className:"mb-24",label:"Subdistrict",id:"subdistrict",variant:"outlined",required:!0}))}}),(0,Y.jsx)(F.Z,{freeSolo:!0,value:g,onChange:function(e,t){t&&t.district&&J(t.district),t&&t.amphoe&&te(t.amphoe),t&&t.province&&ie(t.province),t&&t.zipcode&&ce(t.zipcode)},getOptionLabel:function(e){return e.label||ee||""},inputValue:ee,onInputChange:function(e,t){te(t),""!==t&&pe((0,Ue.searchAddressByAmphoe)(t).slice(0,10))},id:"auto-district",options:o,sx:{width:300},renderInput:function(e){return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},e),{},{className:"mb-24",label:"District",id:"district",variant:"outlined",required:!0}))}}),(0,Y.jsx)(F.Z,{freeSolo:!0,value:N,onChange:function(e,t){t&&t.district&&J(t.district),t&&t.amphoe&&te(t.amphoe),t&&t.province&&ie(t.province),t&&t.zipcode&&ce(t.zipcode)},getOptionLabel:function(e){return e.label||re||""},inputValue:re,onInputChange:function(e,t){ie(t),""!==t&&pe((0,Ue.searchAddressByProvince)(t).slice(0,10))},id:"auto-province",options:o,sx:{width:300},renderInput:function(e){return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},e),{},{className:"mb-24",label:"Province",id:"province",variant:"outlined",required:!0}))}}),(0,Y.jsx)(F.Z,{freeSolo:!0,value:S,onChange:function(e,t){t&&t.district&&J(t.district),t&&t.amphoe&&te(t.amphoe),t&&t.province&&ie(t.province),t&&t.zipcode&&ce(t.zipcode)},getOptionLabel:function(e){return e.label||oe||""},inputValue:oe,onInputChange:function(e,t){ce(t),""!==t&&pe((0,Ue.searchAddressByZipcode)(t).slice(0,10))},id:"auto-zipcode",options:o,sx:{width:300},renderInput:function(e){return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},e),{},{className:"mb-24",label:"zipcode",id:"zipcode",variant:"outlined",required:!0}))}})]}),"new"===n.type?(0,Y.jsx)(Me.Z,{className:"justify-between p-4 pb-16",children:(0,Y.jsx)("div",{className:"px-16",children:(0,Y.jsx)(be.Z,{variant:"contained",color:"secondary",type:"submit",children:"Add"})})}):(0,Y.jsx)(Me.Z,{className:"justify-between p-4 pb-16",children:(0,Y.jsx)("div",{className:"px-16",children:(0,Y.jsx)(be.Z,{variant:"contained",color:"secondary",type:"submit",children:"Save"})})})]})]}))},$e=function(){var e=(0,i.I0)(),t=(0,i.v9)(Te.Z1),n=(0,i.v9)(Ie.H5),l={hidden:{opacity:0,y:40},show:{opacity:1,y:0}},s=(0,r.useState)([]),o=(0,a.Z)(s,2),c=o[0],d=o[1];(0,r.useEffect)((function(){return n&&n.address&&n.address.length>0&&d(n.address),function(){d([])}}),[n]);var u=(0,r.useState)({open:!1,data:{}}),p=(0,a.Z)(u,2),x=p[0],f=p[1],m=function(){f({open:!1,data:{}})};return(0,Y.jsxs)("div",{className:"flex flex-col w-full",children:[!t&&(0,Y.jsx)(Ae.Z,{}),0===c.length&&(0,Y.jsx)(W.E.div,{initial:{opacity:0},animate:{opacity:1,transition:{delay:.1}},className:"flex flex-col flex-1 items-center justify-center h-full m-16",children:(0,Y.jsx)(b.Z,{color:"textSecondary",variant:"h6",children:"No Address!"})}),c.length>0&&(0,Y.jsx)(O.Z,{className:"w-full",children:(0,Y.jsx)(W.E.div,{className:"flex flex-col flex-shrink-0 w-full",variants:{show:{transition:{staggerChildren:.05}}},initial:"hidden",animate:"show",children:c&&c.map((function(t,n){var a="".concat(t.subDistrict,", ").concat(t.district,", ").concat(t.province,", ").concat(t.zipCode);return(0,Y.jsx)(W.E.div,{variants:l,className:"w-full",children:(0,Y.jsxs)(V.ZP,{className:"px-8 py-6 min-h-92 w-full flex justify-between",children:[(0,Y.jsx)(Ee.Z,{classes:{root:"min-w-px px-8 ",primary:"font-medium text-14",secondary:"truncate"},primary:(0,Y.jsxs)("div",{className:"flex flex-col",children:[(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"h6",color:"text.primary",children:t.name}),(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"subtitle2",color:"text.primary",children:t.tel})]}),secondary:(0,Y.jsxs)("div",{className:"whitespace-normal break-words flex flex-col",children:[(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:t.address1}),(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:t.address2}),(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:a})]})}),(0,Y.jsxs)("div",{className:"flex flex-col ",children:[(0,Y.jsx)(D.Z,{color:"primary",onClick:function(){e((0,We.Z1)(t))},size:"large",children:(0,Y.jsx)(De.Z,{})}),(0,Y.jsx)(D.Z,{color:"primary",onClick:function(){f({open:!0,data:t})},size:"large",children:(0,Y.jsx)(Oe.Z,{})})]})]})},n)}))})}),(0,Y.jsxs)(be.Z,{className:"my-8 mx-16",variant:"contained",color:"primary",startIcon:(0,Y.jsx)(Le.Z,{}),onClick:function(){e((0,We.ah)())},children:[(0,Y.jsx)("span",{className:"hidden sm:flex",children:"New Address"}),(0,Y.jsx)("span",{className:"flex sm:hidden",children:"New"})]}),(0,Y.jsx)(Ve,{}),(0,Y.jsxs)(Re.Z,{open:x.open,onClose:m,maxWidth:"sm","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,Y.jsx)(Be.Z,{id:"alert-dialog-title",children:"Are you sure you want to delete this Address?"}),(0,Y.jsx)(Pe.Z,{children:(0,Y.jsx)(Fe.Z,{id:"alert-dialog-description",children:(0,Y.jsxs)("div",{className:"flex flex-col p-8",children:[(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"h6",color:"text.primary",children:x.data.name}),(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"subtitle2",color:"text.primary",children:x.data.tel}),(0,Y.jsxs)("div",{className:"whitespace-normal break-words flex flex-col",children:[(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:x.data.address1}),(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:x.data.address2}),(0,Y.jsx)(b.Z,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:"".concat(x.data.subDistrict,", ").concat(x.data.district,", ").concat(x.data.province,", ").concat(x.data.zipCode)})]})]})})}),(0,Y.jsxs)(Me.Z,{children:[(0,Y.jsx)(be.Z,{onClick:m,color:"primary",children:"Cancel"}),(0,Y.jsx)(be.Z,{onClick:function(){e((0,We.Ro)(x.data)),f({open:!1,data:{}})},color:"primary",autoFocus:!0,children:"Confirm"})]})]})]})},He=n(3463),qe=n(58970),Ge=n(14790),_e=n(75627),Qe={id:null,firstname:"",lastname:"",display:"",email:"",tel:"",remarks:"",channel:"",uid:"",createdAt:new Date,updatedAt:new Date},Je=He.Ry().shape({display:He.Z_().required("You must enter a display name")}),Ye=function(){var e=(0,i.I0)(),t=(0,i.v9)(Te.Z1),n=(0,i.v9)(Ie.H5),a=(0,_e.cI)({mode:"onChange",defaultValues:Qe,resolver:(0,Ge.X)(Je)}),l=a.control,s=(a.watch,a.reset),o=a.handleSubmit,c=a.formState,d=(a.getValues,c.isValid),u=c.dirtyFields,p=(c.errors,(0,r.useCallback)((function(){t&&n&&s((0,f.Z)({},n))}),[t,n,s]));return(0,r.useEffect)((function(){t?p():s((0,f.Z)({},Qe))}),[p,t]),(0,Y.jsx)("div",{className:"flex flex-col relative w-full p-24",children:(0,Y.jsxs)("form",{noValidate:!0,onSubmit:o((function(t){n&&e((0,Ie.uG)((0,f.Z)((0,f.Z)({},n),t)))})),children:[(0,Y.jsx)("div",{className:"flex",children:(0,Y.jsx)(_e.Qr,{control:l,name:"firstname",render:function(e){var t=e.field;return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},t),{},{className:"mb-24",label:"Firstname",id:"firstName",variant:"outlined",fullWidth:!0}))}})}),(0,Y.jsx)("div",{className:"flex",children:(0,Y.jsx)(_e.Qr,{control:l,name:"lastname",render:function(e){var t=e.field;return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},t),{},{className:"mb-24",label:"Lastname",id:"lastName",variant:"outlined",fullWidth:!0}))}})}),(0,Y.jsx)("div",{className:"flex",children:(0,Y.jsx)(_e.Qr,{control:l,name:"display",render:function(e){var t=e.field;return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},t),{},{className:"mb-24",label:"Display Name",id:"display",variant:"outlined",fullWidth:!0,required:!0}))}})}),(0,Y.jsx)("div",{className:"flex",children:(0,Y.jsx)(_e.Qr,{control:l,name:"email",render:function(e){var t=e.field;return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},t),{},{className:"mb-24",label:"Email",id:"email",variant:"outlined",fullWidth:!0}))}})}),(0,Y.jsx)("div",{className:"flex",children:(0,Y.jsx)(_e.Qr,{control:l,name:"tel",render:function(e){var t=e.field;return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},t),{},{className:"mb-24",label:"Mobile",id:"tel",variant:"outlined",fullWidth:!0}))}})}),(0,Y.jsx)("div",{className:"flex",children:(0,Y.jsx)(_e.Qr,{control:l,name:"remarks",render:function(e){var t=e.field;return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},t),{},{className:"mb-24",label:"Remark",id:"remarks",variant:"outlined",multiline:!0,rows:3,fullWidth:!0}))}})}),(0,Y.jsx)("div",{className:"px-16 w-full",children:(0,Y.jsx)(be.Z,{className:"w-full",variant:"contained",color:"primary",type:"submit",disabled:qe.Z.isEmpty(u)||!d,children:"Save"})})]})})},Ke=n(43850),Xe=function(e){var t=(0,i.I0)(),n=(0,r.useState)([]),l=(0,a.Z)(n,2),s=l[0],o=l[1],c=((0,i.v9)(Te.Z1),(0,i.v9)(Ie.H5)),u=(0,i.v9)(p.ir);(0,r.useEffect)((function(){t((0,Ie.XP)())}),[t]),(0,r.useEffect)((function(){if(c&&c.customerLabel){var e,t=null===(e=c.customerLabel)||void 0===e?void 0:e.map((function(e,t){return(0,f.Z)((0,f.Z)({},e),{},{key:t})})),n=Array.from(new Set(t.map((function(e){return e.id})))).map((function(e){return t.find((function(t){return t.id===e}))}));o(n)}}),[c,u]),(0,r.useEffect)((function(){t((0,d.zG)()),s.length>10&&(s.splice(10,s.length-10),t((0,Ke.PV)({message:"Maximum 10 labels per customer.",variant:"warning"})))}),[t,s]);var x=function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n){return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&t((0,Ie.YA)(n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n){var a,r;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(n);case 2:if(!(a=e.sent)||!a.length){e.next=12;break}if(!(a.length+s.length>10)){e.next=8;break}t((0,Ke.PV)({message:"Maximum 10 labels per customer.",autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"})),e.next=12;break;case 8:return e.next=10,[].concat((0,C.Z)(s),(0,C.Z)(a));case 10:r=e.sent,t((0,Ie.uG)((0,f.Z)((0,f.Z)({},c),{},{customerLabel:r})));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n,a){return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length<s.length)){e.next=4;break}t((0,Ie.uG)((0,f.Z)((0,f.Z)({},c),{},{customerLabel:a}))),e.next=8;break;case 4:return e.next=6,a.filter((function(e){return!s.includes(e)}));case 6:e.sent.forEach(function(){var e=(0,S.Z)((0,k.Z)().mark((function e(n){var a,r,i,l,o,d,p;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||!n.id){e.next=7;break}return e.next=3,[].concat((0,C.Z)(s),[n]);case 3:a=e.sent,t((0,Ie.uG)((0,f.Z)((0,f.Z)({},c),{},{customerLabel:a}))),e.next=31;break;case 7:return e.next=9,n.split(" ");case 9:return r=e.sent,e.next=12,r.filter((function(e){return e.length<=15}));case 12:return i=e.sent,e.next=15,i.filter((function(e){return String(e).trim()}));case 15:return i=e.sent,r.length!==i.length&&t((0,Ke.PV)({message:"Maximum 15 characters per 1 label.",variant:"warning"})),e.next=19,i.map((function(e){var t=e.toLowerCase(),n=u.find((function(e){return e.label===t}));return n||{label:t}}));case 19:if(l=e.sent,!(i.length+l.length>10)){e.next=23;break}return t((0,Ke.PV)({message:"Maximum 10 labels per customer.",variant:"warning"})),e.abrupt("return");case 23:return e.next=25,l.filter((function(e){return"string"!==typeof e}));case 25:return(o=e.sent)&&o.length>0&&(d=[].concat((0,C.Z)(s),(0,C.Z)(o)),t((0,Ie.uG)((0,f.Z)((0,f.Z)({},c),{},{customerLabel:d})))),e.next=29,l.filter((function(e){return"string"===typeof e&&""!==e}));case 29:(p=e.sent)&&p.length>0&&m(p);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,Y.jsx)("div",{className:"flex flex-col w-full",children:(0,Y.jsx)(F.Z,{multiple:!0,freeSolo:!0,id:"tags-outlined",options:u,getOptionLabel:function(e){return e.label},value:s,onChange:h,filterSelectedOptions:!0,renderInput:function(e){return(0,Y.jsx)(B.Z,(0,f.Z)((0,f.Z)({},e),{},{variant:"outlined",placeholder:"Customer Label",multiline:!0}))},renderTags:function(e,t){return(0,Y.jsx)("div",{className:"w-full",children:e.map((function(e,n){return(0,Y.jsx)(U.Z,(0,f.Z)((0,f.Z)({},t({index:n})),{},{label:e.label,color:"secondary",variant:"outlined",className:"w-min m-2 rounded",sx:{borderColor:"#8180E7",color:"#8180E7"}}))}))})}})})},et=n(15103),tt=n(1550),nt=n(88797),at=n(59808),rt=function(e){(0,i.I0)();var t=(0,l.s0)(),n=(0,l.UO)(),s=(n.mode,n.id),o=(0,i.v9)(Te.Z1),c=(0,r.useState)(),d=(0,a.Z)(c,2),u=d[0],p=d[1];(0,r.useEffect)((function(){o&&o.history&&o.history.length&&p(o.history.find((function(e){return e.id===s})))}),[o,s]);return o&&o.history&&o.history.length&&u?(0,Y.jsxs)("div",{className:"flex flex-col justify-center mx-4",children:[(0,Y.jsx)(at.Z,{className:"mb-48"}),(0,Y.jsxs)(tt.Z,{variant:"filled",className:"w-full",children:[(0,Y.jsx)(et.Z,{id:"demo-simple-select-filled-label",children:"Ticket"}),(0,Y.jsx)(nt.Z,{labelId:"demo-simple-select-filled-label ",id:"demo-simple-select-filled",value:u,defaultValue:u,onChange:function(e){window.location.href.search("history"),t("/apps/chat/".concat(e.target.value.id))},renderValue:function(e){var t="".concat(e.description?"".concat(e.description," - "):""," ").concat((0,G.Z)(new Date(e.createdAt),"PP"));return(0,Y.jsx)("span",{children:t})},children:o.history.map((function(e,t){var n="".concat(t+1," : ").concat(e.description?"".concat(e.description," - "):""," ").concat((0,G.Z)(new Date(e.createdAt),"PP"));return(0,Y.jsx)(M.Z,{value:e,disabled:e.id===u.id,children:n},t)}))})]})]}):null},it=function(e){var t=(0,i.I0)(),n=(0,c.Z)((function(e){return e.breakpoints.down("lg")})),s=(0,r.useContext)(J.Z),o=(s.setCustomerSidebarOpen,s.customerSidebarOpen,(0,l.UO)()),p=(o.mode,o.id),x=((0,i.v9)(Ie.H5),(0,i.v9)(Te.Z1)),f=(0,i.v9)((function(e){return(0,d.j0)(e,p)})),m=(0,i.v9)((function(e){return(0,u.jm)(e,null===x||void 0===x?void 0:x.channelId)})),h=(0,r.useState)(!1),Z=(0,a.Z)(h,2),v=Z[0],j=Z[1];(0,r.useEffect)((function(){f&&f.customerId&&t((0,Ie.jy)({customerId:f.customerId}))}),[f,t]);var g=function(e){return function(t,n){j(!!n&&e)}};return p&&f&&m?(0,Y.jsxs)("div",{className:(0,w.Z)("flex flex-col flex-auto h-full",n?"w-[333px]":"w-full"),children:[(0,Y.jsxs)(ke.Z,{color:"primary",expanded:"information"===v,onChange:g("information"),children:[(0,Y.jsx)(Se.Z,{expandIcon:(0,Y.jsx)(Ce.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:f.customer?(0,Y.jsxs)("div",{className:"flex flex-row space-x-12 items-center",children:[(0,Y.jsx)(Q.f4,{className:"relative w-48 h-48",contact:{pictureURL:f.customer.pictureURL,display:f.customer.display},channel:m}),(0,Y.jsxs)("div",{className:"flex flex-col space-y-4  max-w-[170px]",children:[(0,Y.jsx)(b.Z,{color:"inherit",className:"text-16 font-semibold truncate",children:f.customer.display}),(0,Y.jsx)(b.Z,{variant:"subtitle2",children:m.name})]})]}):(0,Y.jsx)(b.Z,{children:"Customer Information"})}),(0,Y.jsx)(ze.Z,{children:(0,Y.jsx)(Ye,{})})]}),(0,Y.jsxs)(ke.Z,{expanded:"address"===v,onChange:g("address"),children:[(0,Y.jsx)(Se.Z,{expandIcon:(0,Y.jsx)(Ce.Z,{}),"aria-controls":"panel3a-content",id:"panel3a-header",children:(0,Y.jsx)(b.Z,{children:"Address"})}),(0,Y.jsx)(ze.Z,{children:(0,Y.jsx)($e,{})})]}),(0,Y.jsxs)(ke.Z,{expanded:"label"===v,onChange:g("label"),children:[(0,Y.jsx)(Se.Z,{expandIcon:(0,Y.jsx)(Ce.Z,{}),"aria-controls":"panel2a-content",id:"panel2a-header",children:(0,Y.jsx)(b.Z,{children:"Label"})}),(0,Y.jsx)(ze.Z,{children:(0,Y.jsx)(Xe,{})})]}),(0,Y.jsxs)(ke.Z,{expanded:"ticket"===v,onChange:g("ticket"),children:[(0,Y.jsx)(Se.Z,{expandIcon:(0,Y.jsx)(Ce.Z,{}),"aria-controls":"panel2a-content",id:"panel2a-header",children:(0,Y.jsx)(b.Z,{children:"Ticket"})}),(0,Y.jsx)(ze.Z,{children:(0,Y.jsx)(rt,{})})]})]}):null},lt=function(e){(0,i.I0)();var t=(0,c.Z)((function(e){return e.breakpoints.down("lg")})),n=(0,r.useContext)(J.Z),a=n.customerSidebarOpen,l=n.commentSidebarOpen,s=n.handleRightSidebarClose;return(0,r.useEffect)((function(){console.log("customerSidebarOpen ",a),console.log("commentSidebarOpen ",l)}),[l,a]),(0,Y.jsx)(h.Z,{sx:{bgcolor:"background.paper"},className:(0,w.Z)(t?"w-[333px] flex grow":"w-[399px] flex grow","h-full"),children:(0,Y.jsxs)("div",{className:"flex flex-col flex-auto justify-between w-[333px]",children:[(0,Y.jsx)(h.Z,{className:"border-b-1",sx:{backgroundColor:function(e){return"light"===e.palette.mode?(0,g.$n)(e.palette.background.default,.4):(0,g.$n)(e.palette.background.default,.02)}},children:(0,Y.jsxs)(I.Z,{className:"flex items-center justify-between px-10",children:[(0,Y.jsx)("div",{className:"flex flex-row justify-start space-x-5 items-center",children:(0,Y.jsxs)(b.Z,{className:"px-4 font-medium text-16",color:"inherit",variant:"subtitle1",children:[a&&(0,Y.jsx)(Y.Fragment,{children:"Customer"}),l&&(0,Y.jsx)(Y.Fragment,{children:"Comment"})]})}),(0,Y.jsx)(D.Z,{color:"inherit",size:"large",onClick:s,children:(0,Y.jsx)(y.Z,{children:"heroicons-outline:x"})})]})}),a?(0,Y.jsx)(it,{}):null,l?(0,Y.jsx)(Ne,{}):null]})})},st=(0,s.ZP)(o.Z)((function(e){e.theme;return{"& .FusePageSimple-content":{display:"flex",flexDirection:"column",flex:"1 1 100%",height:"100%"},"& .FusePageSimple-sidebarContent":{display:"flex",flexDirection:"column",height:"100%"}}})),ot=function(e){var t=(0,i.I0)(),n=(0,c.Z)((function(e){return e.breakpoints.down("lg")})),s=(0,r.useState)(!n),o=(0,a.Z)(s,2),f=o[0],m=o[1],h=(0,r.useState)(!1),b=(0,a.Z)(h,2),Z=b[0],v=b[1],j=(0,r.useState)(!1),g=(0,a.Z)(j,2),y=g[0],w=g[1],N=(0,l.TH)(),C=(0,l.UO)();(0,r.useEffect)((function(){return t((0,u.Ky)()),t((0,x.TT)()),t((0,p.cE)()),function(){t((0,d.iw)())}}),[t]),(0,r.useEffect)((function(){m(!n)}),[n]),(0,r.useEffect)((function(){n&&(C.id?m(!1):m(!0)),N.hash&&w(!0)}),[N,n,C.id]);var k=(0,r.useCallback)((function(){v(!1),w(!0)}),[]),S=(0,r.useCallback)((function(){v(!0),w(!1)}),[]),z=(0,r.useCallback)((function(){v(!1),w(!1)}),[]),I=(0,r.useMemo)((function(){return{setMainSidebarOpen:m,customerSidebarOpen:Z,commentSidebarOpen:y,handleCommentSidebarOpen:k,handleCustomerSidebarOpen:S,handleRightSidebarClose:z}}),[m,Z,y,k,S,z]);return(0,Y.jsx)(J.Z.Provider,{value:I,children:(0,Y.jsx)(st,{content:(0,Y.jsx)(l.j3,{}),leftSidebarContent:(0,Y.jsx)(xe,{}),leftSidebarOpen:f,leftSidebarOnClose:function(){m(!1)},leftSidebarWidth:400,rightSidebarContent:(0,Y.jsx)(lt,{}),rightSidebarOpen:Boolean(y||Z),rightSidebarOnClose:function(){v(!1),w(!1)},rightSidebarWidth:400,scroll:"content"})})}}}]);